import { IO_Port } from "../../instructions.js";
export class BlockRAM {
    constructor() {
        this.blockGrid = [
            [
                [3, 3, 3, 3, 3, 3, 3, 1,],
                [3, 3, 3, 3, 3, 3, 1, 1,],
                [3, 3, 3, 3, 3, 3, 1, 1,],
                [3, 3, 3, 3, 3, 3, 1, 1,],
                [3, 3, 3, 3, 3, 1, 1, 1,],
                [3, 3, 3, 3, 3, 1, 1, 1,],
                [3, 3, 3, 3, 1, 1, 1, 1,],
                [3, 3, 3, 1, 1, 1, 1, 1,],
            ],
            [
                [3, 3, 3, 3, 1, 1, 1, 0,],
                [3, 3, 3, 1, 1, 1, 0, 0,],
                [3, 3, 1, 1, 1, 1, 0, 0,],
                [3, 3, 1, 1, 1, 1, 0, 0,],
                [3, 1, 1, 1, 1, 0, 0, 0,],
                [1, 1, 1, 1, 1, 0, 0, 0,],
                [1, 1, 1, 1, 0, 0, 0, 0,],
                [1, 1, 1, 0, 0, 0, 0, 0,],
            ],
            [
                [1, 1, 1, 1, 0, 0, 0, 0,],
                [1, 1, 1, 0, 0, 0, 0, 0,],
                [1, 1, 0, 0, 5, 0, 0, 0,],
                [1, 1, 0, 0, 0, 0, 0, 0,],
                [1, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
            ],
            [
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 5, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
            ],
            [
                [0, 0, 0, 6, 6, 6, 0, 0,],
                [0, 0, 6, 6, 6, 6, 6, 0,],
                [0, 0, 6, 6, 5, 6, 6, 0,],
                [0, 0, 6, 6, 6, 6, 6, 0,],
                [0, 0, 0, 6, 6, 6, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
            ],
            [
                [0, 0, 0, 6, 6, 6, 0, 0,],
                [0, 0, 6, 6, 6, 6, 6, 0,],
                [0, 0, 6, 6, 5, 6, 6, 0,],
                [0, 0, 6, 6, 6, 6, 6, 0,],
                [0, 0, 0, 6, 6, 6, 6, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
            ],
            [
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 6, 6, 0, 0, 0,],
                [0, 0, 0, 6, 6, 6, 0, 0,],
                [0, 0, 0, 6, 6, 6, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
            ],
            [
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 6, 0, 0, 0,],
                [0, 0, 0, 6, 6, 6, 0, 0,],
                [0, 0, 0, 0, 6, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
                [0, 0, 0, 0, 0, 0, 0, 0,],
            ]
        ];
        this.x = 0;
        this.y = 0;
        this.z = 0;
        this.id = 0;
        this.inputs = {
            [IO_Port.BLOCKRAM_ID]: () => {
                var _a;
                return (_a = this.blockGrid[this.x][this.y][this.z]) !== null && _a !== void 0 ? _a : 0;
            },
            [IO_Port.BLOCKRAM_ZI]: () => {
                var _a;
                return (this.z << 4) | ((_a = this.blockGrid[this.x][this.y][this.z]) !== null && _a !== void 0 ? _a : 0);
            },
            [IO_Port.BLOCKRAM_SETID]: () => {
                this.blockGrid[this.x][this.y][this.z] = this.id;
                return 0;
            }
        };
        this.outputs = {
            [IO_Port.BLOCKRAM_XY]: (i) => {
                this.x = i >> 4;
                this.y = i & 0x0F;
            },
            [IO_Port.BLOCKRAM_ZI]: (i) => {
                this.z = i >> 4;
                this.id = i & 0x0F;
            }
        };
    }
    getBlock(x, y, z) {
        return this.blockGrid[x][y][z];
    }
    setBlock(x, y, z, id) {
        this.blockGrid[x][y][z] = id;
    }
}